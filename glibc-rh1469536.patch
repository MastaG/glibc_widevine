commit 8c2c51115bc19b18491b3decf99db460ea378730
Author: Florian Weimer <fweimer@redhat.com>
Date:   Tue Jul 11 14:50:46 2017 +0200

    Revert "S390: Sync ptrace.h with kernel. [BZ #21539]"
    
    This reverts commit b08a6a0dea63742313ed3d9577c1e2d83436b196.

diff --git a/sysdeps/s390/fpu/fesetenv.c b/sysdeps/s390/fpu/fesetenv.c
index 0f64a3f..4c9bcf0 100644
--- a/sysdeps/s390/fpu/fesetenv.c
+++ b/sysdeps/s390/fpu/fesetenv.c
@@ -20,6 +20,8 @@
 #include <fenv_libc.h>
 #include <fpu_control.h>
 #include <stddef.h>
+#include <asm/ptrace.h>
+#include <sys/ptrace.h>
 #include <unistd.h>
 
 int
diff --git a/sysdeps/unix/sysv/linux/s390/Makefile b/sysdeps/unix/sysv/linux/s390/Makefile
index f30a6bb..3867c33 100644
--- a/sysdeps/unix/sysv/linux/s390/Makefile
+++ b/sysdeps/unix/sysv/linux/s390/Makefile
@@ -29,7 +29,3 @@ CFLAGS-elision-trylock.c = $(elision-CFLAGS)
 CFLAGS-elision-unlock.c = $(elision-CFLAGS)
 endif
 endif
-
-ifeq ($(subdir),misc)
-tests += tst-ptrace-singleblock
-endif
diff --git a/sysdeps/unix/sysv/linux/s390/sys/ptrace.h b/sysdeps/unix/sysv/linux/s390/sys/ptrace.h
index 88079fc..7caf101 100644
--- a/sysdeps/unix/sysv/linux/s390/sys/ptrace.h
+++ b/sysdeps/unix/sysv/linux/s390/sys/ptrace.h
@@ -89,9 +89,25 @@ enum __ptrace_request
   PTRACE_SINGLESTEP = 9,
 #define PT_STEP PTRACE_SINGLESTEP
 
-  /* Execute process until next taken branch.  */
-  PTRACE_SINGLEBLOCK = 12,
-#define PT_STEPBLOCK PTRACE_SINGLEBLOCK
+  /* Get all general purpose registers used by a processes.
+     This is not supported on all machines.  */
+   PTRACE_GETREGS = 12,
+#define PT_GETREGS PTRACE_GETREGS
+
+  /* Set all general purpose registers used by a processes.
+     This is not supported on all machines.  */
+   PTRACE_SETREGS = 13,
+#define PT_SETREGS PTRACE_SETREGS
+
+  /* Get all floating point registers used by a processes.
+     This is not supported on all machines.  */
+   PTRACE_GETFPREGS = 14,
+#define PT_GETFPREGS PTRACE_GETFPREGS
+
+  /* Set all floating point registers used by a processes.
+     This is not supported on all machines.  */
+   PTRACE_SETFPREGS = 15,
+#define PT_SETFPREGS PTRACE_SETFPREGS
 
   /* Attach to a process that is already running. */
   PTRACE_ATTACH = 16,
@@ -151,26 +167,8 @@ enum __ptrace_request
   PTRACE_SETSIGMASK = 0x420b,
 #define PTRACE_SETSIGMASK PTRACE_SETSIGMASK
 
-  PTRACE_SECCOMP_GET_FILTER = 0x420c,
+  PTRACE_SECCOMP_GET_FILTER = 0x420c
 #define PTRACE_SECCOMP_GET_FILTER PTRACE_SECCOMP_GET_FILTER
-
-  PTRACE_PEEKUSR_AREA = 0x5000,
-#define PTRACE_PEEKUSR_AREA PTRACE_PEEKUSR_AREA
-
-  PTRACE_POKEUSR_AREA = 0x5001,
-#define PTRACE_POKEUSR_AREA PTRACE_POKEUSR_AREA
-
-  PTRACE_GET_LAST_BREAK = 0x5006,
-#define PTRACE_GET_LAST_BREAK PTRACE_GET_LAST_BREAK
-
-  PTRACE_ENABLE_TE = 0x5009,
-#define PTRACE_ENABLE_TE PTRACE_ENABLE_TE
-
-  PTRACE_DISABLE_TE = 0x5010,
-#define PTRACE_DISABLE_TE PTRACE_DISABLE_TE
-
-  PTRACE_TE_ABORT_RAND = 0x5011
-#define PTRACE_TE_ABORT_RAND PTRACE_TE_ABORT_RAND
 };
 
 
